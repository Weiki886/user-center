import{u as P,o as C,a as i,c as L,b as r,w as o,d as U,e as R,r as a,f as q,g as z,h as p,i as f,j as _,k as B}from"./index-CrxnEdR7.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{U as V}from"./UserOutlined-DudF8kc9.js";import{L as O}from"./LockOutlined-DxT2UMAA.js";const S={class:"login-container"},$={__name:"Login",setup(h){const c=R(),g=U(),v=P(),d=_(null),u=_(!1),s=B({userAccount:"",userPassword:""}),w={userAccount:[{required:!0,message:"请输入账号",trigger:"blur"},{min:4,max:20,message:"账号长度在4-20之间",trigger:"blur"}],userPassword:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在6-20之间",trigger:"blur"}]},b=async()=>{await d.value.validate(),u.value=!0;try{await v.loginAction(s.userAccount,s.userPassword),i.success("登录成功"),c.push("/")}catch(l){i.error(l.message||"登录失败")}finally{u.value=!1}};return C(()=>{g.query.from==="passwordChanged"&&(i.success("密码修改成功，请重新登录"),c.replace({path:"/login"}))}),(l,e)=>{const k=a("a-input"),t=a("a-form-item"),y=a("a-input-password"),m=a("a-button"),x=a("a-form"),A=a("a-card");return q(),L("div",S,[r(A,{class:"login-card"},{default:o(()=>[e[5]||(e[5]=z("h2",null,"用户登录",-1)),r(x,{model:s,rules:w,ref_key:"formRef",ref:d,layout:"vertical"},{default:o(()=>[r(t,{label:"账号",name:"userAccount"},{default:o(()=>[r(k,{value:s.userAccount,"onUpdate:value":e[0]||(e[0]=n=>s.userAccount=n),placeholder:"请输入账号",size:"large"},{prefix:o(()=>[r(p(V))]),_:1},8,["value"])]),_:1}),r(t,{label:"密码",name:"userPassword"},{default:o(()=>[r(y,{value:s.userPassword,"onUpdate:value":e[1]||(e[1]=n=>s.userPassword=n),placeholder:"请输入密码",size:"large"},{prefix:o(()=>[r(p(O))]),_:1},8,["value"])]),_:1}),r(t,null,{default:o(()=>[r(m,{type:"primary",onClick:b,loading:u.value,size:"large",block:""},{default:o(()=>[...e[3]||(e[3]=[f(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1}),r(t,null,{default:o(()=>[r(m,{type:"link",onClick:e[2]||(e[2]=n=>l.$router.push("/register"))},{default:o(()=>[...e[4]||(e[4]=[f("还没有账号？去注册",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},T=N($,[["__scopeId","data-v-f33f5828"]]);export{T as default};
