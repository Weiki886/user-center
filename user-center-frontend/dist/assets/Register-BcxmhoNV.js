import{b as e,I as R,u as j,o as V,c as h,w as t,l as q,a as g,r as p,k as B,j as b,e as N,f as w,g as O,h as m,L as M,i as C}from"./index-CrxnEdR7.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{U as x}from"./UserOutlined-DudF8kc9.js";import{L as S}from"./LockOutlined-DxT2UMAA.js";var E={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64L128 192v384c0 212.1 171.9 384 384 384s384-171.9 384-384V192L512 64zm312 512c0 172.3-139.7 312-312 312S200 748.3 200 576V246l312-110 312 110v330z"}},{tag:"path",attrs:{d:"M378.4 475.1a35.91 35.91 0 00-50.9 0 35.91 35.91 0 000 50.9l129.4 129.4 2.1 2.1a33.98 33.98 0 0048.1 0L730.6 434a33.98 33.98 0 000-48.1l-2.8-2.8a33.98 33.98 0 00-48.1 0L483 579.7 378.4 475.1z"}}]},name:"safety",theme:"outlined"};function z(l){for(var s=1;s<arguments.length;s++){var o=arguments[s]!=null?Object(arguments[s]):{},u=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),u.forEach(function(c){D(l,c,o[c])})}return l}function D(l,s,o){return s in l?Object.defineProperty(l,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):l[s]=o,l}var y=function(s,o){var u=z({},s,o.attrs);return e(R,z({},u,{icon:E}),null)};y.displayName="SafetyOutlined";y.inheritAttrs=!1;const T={class:"register-container"},F={class:"captcha-container"},G=["src"],H={__name:"Register",setup(l){const s=N(),o=j(),u=b(null),c=b(!1),a=B({username:"",userAccount:"",userPassword:"",checkPassword:"",captchaId:"",captchaCode:""}),v=b(""),I={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度在2-20之间",trigger:"blur"}],userAccount:[{required:!0,message:"请输入账号",trigger:"blur"},{min:4,max:20,message:"账号长度在4-20之间",trigger:"blur"}],userPassword:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在6-20之间",trigger:"blur"}],captchaCode:[{required:!0,message:"请输入验证码",trigger:"blur"}]},f=async()=>{try{const i=await q();a.captchaId=i.data.captchaId,v.value=i.data.captchaImage}catch(i){g.error("获取验证码失败"),console.error("获取验证码失败:",i)}},A=async()=>{if(a.userPassword!==a.checkPassword){g.error("两次密码不一致");return}await u.value.validate(),c.value=!0;try{await o.registerAction(a.username,a.userAccount,a.userPassword,a.checkPassword,a.captchaId,a.captchaCode),g.success("注册成功"),s.push("/login")}catch(i){g.error(i.message||"注册失败"),f()}finally{c.value=!1}};return V(()=>{f()}),(i,r)=>{const _=p("a-input"),d=p("a-form-item"),P=p("a-input-password"),k=p("a-button"),L=p("a-form"),U=p("a-card");return w(),h("div",T,[e(U,{class:"register-card"},{default:t(()=>[r[8]||(r[8]=O("h2",null,"用户注册",-1)),e(L,{model:a,rules:I,ref_key:"formRef",ref:u,layout:"vertical"},{default:t(()=>[e(d,{label:"用户名",name:"username"},{default:t(()=>[e(_,{value:a.username,"onUpdate:value":r[0]||(r[0]=n=>a.username=n),placeholder:"请输入用户名",size:"large"},{prefix:t(()=>[e(m(x))]),_:1},8,["value"])]),_:1}),e(d,{label:"账号",name:"userAccount"},{default:t(()=>[e(_,{value:a.userAccount,"onUpdate:value":r[1]||(r[1]=n=>a.userAccount=n),placeholder:"请输入账号",size:"large"},{prefix:t(()=>[e(m(x))]),_:1},8,["value"])]),_:1}),e(d,{label:"密码",name:"userPassword"},{default:t(()=>[e(P,{value:a.userPassword,"onUpdate:value":r[2]||(r[2]=n=>a.userPassword=n),placeholder:"请输入密码",size:"large"},{prefix:t(()=>[e(m(S))]),_:1},8,["value"])]),_:1}),e(d,{label:"确认密码"},{default:t(()=>[e(P,{value:a.checkPassword,"onUpdate:value":r[3]||(r[3]=n=>a.checkPassword=n),placeholder:"请确认密码",size:"large"},{prefix:t(()=>[e(m(S))]),_:1},8,["value"])]),_:1}),e(d,{label:"验证码",name:"captchaCode"},{default:t(()=>[O("div",F,[e(_,{value:a.captchaCode,"onUpdate:value":r[4]||(r[4]=n=>a.captchaCode=n),placeholder:"请输入验证码",size:"large",class:"captcha-input"},{prefix:t(()=>[e(m(y))]),_:1},8,["value"]),v.value?(w(),h("img",{key:0,src:v.value,class:"captcha-image",onClick:f,title:"点击刷新验证码"},null,8,G)):(w(),h("div",{key:1,class:"captcha-loading",onClick:f},[e(m(M))]))])]),_:1}),e(d,null,{default:t(()=>[e(k,{type:"primary",onClick:A,loading:c.value,size:"large",block:""},{default:t(()=>[...r[6]||(r[6]=[C(" 注册 ",-1)])]),_:1},8,["loading"])]),_:1}),e(d,null,{default:t(()=>[e(k,{type:"link",onClick:r[5]||(r[5]=n=>i.$router.push("/login"))},{default:t(()=>[...r[7]||(r[7]=[C("已有账号？去登录",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},Y=$(H,[["__scopeId","data-v-f5adb3ab"]]);export{Y as default};
